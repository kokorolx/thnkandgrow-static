{"id":359,"date":"2023-05-13T22:36:23","date_gmt":"2023-05-13T15:36:23","guid":{"rendered":"https:\/\/thnkandgrow.com\/?p=359"},"modified":"2023-05-13T22:36:23","modified_gmt":"2023-05-13T15:36:23","slug":"understanding-user-scripts-when-launching-ec2-instances","status":"publish","type":"post","link":"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/","title":{"rendered":"Understanding User Scripts When Launching EC2 Instances"},"content":{"rendered":"\n<p>Amazon Elastic Compute Cloud (EC2) is a popular cloud computing service that allows users to launch virtual servers, also known as instances, in the cloud. When launching an EC2 instance, users can provide a user script, also known as user data, that will be executed during the instance&#8217;s launch process. In this blog post, we will discuss user scripts in more detail and how they can be used to automate instance configuration and management tasks.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<h2 class=\"wp-block-heading\">What are User Scripts?<\/h2>\n\n\n\n<p>User scripts are scripts that are executed when an EC2 instance is launched. They can be written in any scripting language, including bash, Python, or PowerShell, and are passed to the instance during launch as part of the instance metadata. User scripts can be used to perform various tasks, such as installing software, configuring the instance, and running custom scripts.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Why Use User Scripts?<\/h2>\n\n\n\n<p>User scripts can be used to automate the process of launching and configuring EC2 instances. This can save time and reduce the chance of errors when configuring instances manually. For example, you can use user scripts to automatically install and configure web servers, databases, or other software on the instance. User scripts can also be used to customize instances based on your specific needs, such as setting up a specific directory structure or configuring the network settings.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">How to Use User Scripts?<\/h2>\n\n\n\n<p>To use a user script when launching an EC2 instance, you can provide the script as part of the instance&#8217;s user data. This can be done through the EC2 console, API, or command-line interface. When the instance is launched, the user script will be passed to the instance and executed automatically.<\/p>\n\n\n\n<p>It&#8217;s important to note that user scripts should be idempotent, meaning that they should be able to be executed multiple times without causing issues. This is because EC2 instances can be stopped and started multiple times during their lifetime, and the user script will be executed each time the instance is launched.<\/p>\n\n\n\n<p>Example user script to deploy Rails app with redis, nodejs, ruby installed with rvm, postgresql and puma config for nginx (for <strong>ubuntu<\/strong>)<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>#!\/bin\/bash\nsudo apt-get update\nsudo apt-get -y install build-essential libssl-dev libreadline-dev zlib1g-dev git\nsudo apt-get -y install libpq-dev postgresql postgresql-contrib\nsudo apt-get -y install redis-server\nsudo apt-get -y install nodejs\nsudo apt-get -y install nginx\n\n# Install RVM and Ruby\nsudo apt-add-repository -y ppa:rael-gc\/rvm\nsudo apt-get update\nsudo apt-get -y install rvm\nsource \/etc\/profile.d\/rvm.sh\nrvm install 2.7.4\nrvm use 2.7.4 --default\n\n# Install Bundler\ngem install bundler\n\n# Configure PostgreSQL\nsudo -u postgres createuser --superuser ubuntu\nsudo -u postgres createdb -O ubuntu myapp_production\n\n# Configure Nginx\nsudo rm \/etc\/nginx\/sites-enabled\/default\nsudo touch \/etc\/nginx\/sites-available\/myapp\nsudo ln -s \/etc\/nginx\/sites-available\/myapp \/etc\/nginx\/sites-enabled\/myapp\nsudo bash -c \"cat > \/etc\/nginx\/sites-available\/myapp\" &lt;&lt;EOF\nupstream myapp {\n  server unix:\/\/\/var\/www\/myapp\/myapp.sock;\n}\n\nserver {\n  listen 80;\n  server_name myapp.com;\n\n  root \/var\/www\/myapp\/public;\n\n  try_files \\$uri\/index.html \\$uri @myapp;\n\n  location @myapp {\n    proxy_pass http:\/\/myapp;\n    proxy_set_header Host \\$host;\n    proxy_set_header X-Real-IP \\$remote_addr;\n    proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto \\$scheme;\n    proxy_redirect off;\n    proxy_buffering off;\n    proxy_http_version 1.1;\n    proxy_set_header Connection '';\n    chunked_transfer_encoding off;\n    proxy_cache_bypass \\$http_pragma;\n    proxy_cache_revalidate on;\n    proxy_cache_valid 200 5m;\n    expires 5m;\n  }\n}\nEOF\n\nsudo service nginx restart\n<\/code><\/pre>\n\n\n\n<p>When the instance is booted for the first time, this script will run and the output will be in the\u00a0<code>\/var\/log\/cloud-init-output.log<\/code>\u00a0directory on your instance.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Best Practices for Using User Scripts<\/h2>\n\n\n\n<p>When using user scripts, there are some best practices to follow to ensure that they are effective and reliable:<\/p>\n\n\n\n<ol><li>Use version control: User scripts should be stored in a version control system, such as Git, to ensure that they can be easily tracked and modified over time.<\/li><li>Test your scripts: Before using user scripts in production, they should be thoroughly tested to ensure that they work as expected.<\/li><li>Keep scripts simple: User scripts should be simple and easy to read, to avoid potential issues when troubleshooting.<\/li><li>Use cloud-init: Cloud-init is a tool that can be used to configure and customize instances when they are launched. It can be used to install packages, run scripts, and set up users and SSH keys.<\/li><li>Use pre-built scripts: There are many pre-built scripts available online that can be used as a starting point for configuring instances. These can save time and reduce the risk of errors when writing user scripts from scratch.<\/li><\/ol>\n\n\n\n<h2 class=\"wp-block-heading\">Conclusion<\/h2>\n\n\n\n<p>User scripts are a powerful tool for automating the process of launching and configuring EC2 instances. By providing a script during instance launch, users can automate the installation and configuration of software, customize instances to their specific needs, save time, and reduce the risk of errors when configuring instances manually. By following best practices for using user scripts, such as testing scripts and keeping them simple, users can ensure that their instances are configured reliably and effectively.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p>Notion: https:\/\/www.notion.so\/hoangtamle\/Deploy-rails-to-AWS-47d46f0310e54ebcb9b0c11e6b262b49?pvs=4<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Amazon Elastic Compute Cloud (EC2) is a popular cloud computing service that allows users to launch virtual servers, also known as instances, in the cloud. When launching an EC2 instance, users can provide a user script, also known as user data, that will be executed during the instance&#8217;s launch process. In this blog post, we [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":362,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[62,6,53],"tags":[12],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v16.4 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Understanding User Scripts When Launching EC2 Instances &raquo; Th?nk And Grow<\/title>\n<meta name=\"description\" content=\"Dive deep into the latest trends and insights in technology with our engaging articles. Stay informed and ahead of the curve with our expert analysis and in-depth coverage.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Understanding User Scripts When Launching EC2 Instances &raquo; Th?nk And Grow\" \/>\n<meta property=\"og:description\" content=\"Dive deep into the latest trends and insights in technology with our engaging articles. Stay informed and ahead of the curve with our expert analysis and in-depth coverage.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/\" \/>\n<meta property=\"og:site_name\" content=\"Th?nk And Grow\" \/>\n<meta property=\"article:published_time\" content=\"2023-05-13T15:36:23+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/s3.amazonaws.com\/thnkandgrow.com-media\/wp-content\/uploads\/2023\/05\/13223538\/Amazon-EC2.jpg\" \/>\n\t<meta property=\"og:image:width\" content=\"750\" \/>\n\t<meta property=\"og:image:height\" content=\"375\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:label1\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data1\" content=\"4 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/thnkandgrow.com\/#website\",\"url\":\"https:\/\/thnkandgrow.com\/\",\"name\":\"Th?nk And Grow\",\"description\":\"Just Do It!\",\"publisher\":{\"@id\":\"https:\/\/thnkandgrow.com\/#\/schema\/person\/4056838e18c94bc665494c1e8f9f2873\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/thnkandgrow.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/s3.amazonaws.com\/thnkandgrow.com-media\/wp-content\/uploads\/2023\/05\/13223538\/Amazon-EC2.jpg\",\"contentUrl\":\"https:\/\/s3.amazonaws.com\/thnkandgrow.com-media\/wp-content\/uploads\/2023\/05\/13223538\/Amazon-EC2.jpg\",\"width\":750,\"height\":375},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#webpage\",\"url\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/\",\"name\":\"Understanding User Scripts When Launching EC2 Instances &raquo; Th?nk And Grow\",\"isPartOf\":{\"@id\":\"https:\/\/thnkandgrow.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#primaryimage\"},\"datePublished\":\"2023-05-13T15:36:23+00:00\",\"dateModified\":\"2023-05-13T15:36:23+00:00\",\"description\":\"Dive deep into the latest trends and insights in technology with our engaging articles. Stay informed and ahead of the curve with our expert analysis and in-depth coverage.\",\"breadcrumb\":{\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"item\":{\"@type\":\"WebPage\",\"@id\":\"https:\/\/thnkandgrow.com\/\",\"url\":\"https:\/\/thnkandgrow.com\/\",\"name\":\"Home\"}},{\"@type\":\"ListItem\",\"position\":2,\"item\":{\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#webpage\"}}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#webpage\"},\"author\":{\"@id\":\"https:\/\/thnkandgrow.com\/#\/schema\/person\/4056838e18c94bc665494c1e8f9f2873\"},\"headline\":\"Understanding User Scripts When Launching EC2 Instances\",\"datePublished\":\"2023-05-13T15:36:23+00:00\",\"dateModified\":\"2023-05-13T15:36:23+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#webpage\"},\"wordCount\":640,\"publisher\":{\"@id\":\"https:\/\/thnkandgrow.com\/#\/schema\/person\/4056838e18c94bc665494c1e8f9f2873\"},\"image\":{\"@id\":\"https:\/\/thnkandgrow.com\/blog\/2023\/05\/13\/understanding-user-scripts-when-launching-ec2-instances\/#primaryimage\"},\"thumbnailUrl\":\"https:\/\/s3.amazonaws.com\/thnkandgrow.com-media\/wp-content\/uploads\/2023\/05\/13223538\/Amazon-EC2.jpg\",\"keywords\":[\"AWS\"],\"articleSection\":[\"AWS\",\"Technology\",\"Tips\"],\"inLanguage\":\"en-US\"},{\"@type\":[\"Person\",\"Organization\"],\"@id\":\"https:\/\/thnkandgrow.com\/#\/schema\/person\/4056838e18c94bc665494c1e8f9f2873\",\"name\":\"kokorolx\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/thnkandgrow.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/s3.amazonaws.com\/thnkandgrow.com-media\/wp-content\/uploads\/2023\/05\/13223538\/Amazon-EC2.jpg\",\"contentUrl\":\"https:\/\/s3.amazonaws.com\/thnkandgrow.com-media\/wp-content\/uploads\/2023\/05\/13223538\/Amazon-EC2.jpg\",\"width\":750,\"height\":375,\"caption\":\"kokorolx\"},\"logo\":{\"@id\":\"https:\/\/thnkandgrow.com\/#personlogo\"},\"sameAs\":[\"https:\/\/thnkandgrow.com\"],\"url\":\"https:\/\/thnkandgrow.com\/blog\/author\/kokoro-lehoanggmail-com\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/posts\/359"}],"collection":[{"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/comments?post=359"}],"version-history":[{"count":2,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/posts\/359\/revisions"}],"predecessor-version":[{"id":361,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/posts\/359\/revisions\/361"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/media\/362"}],"wp:attachment":[{"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/media?parent=359"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/categories?post=359"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/thnkandgrow.com\/wp-json\/wp\/v2\/tags?post=359"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}